<!DOCTYPE html>
<html lang="pt-br">
<head> <!-- Metas -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Titulo -->
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- CSS Tabulator -->
    <link href="https://unpkg.com/tabulator-tables@6.3.1/dist/css/tabulator.min.css" rel="stylesheet">
    <!-- CSS Local -->
    <link rel="stylesheet" href="/css/gourmet.css">
</head>
<body data-bs-theme="dark">
    <div class="modal fade" id="modal_nova_venda" data-bs-keyboard="true" tabindex="-1">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-header d-flex justify-content-between">
                    <h5 class="modal-title">Nova Venda</h5>
                    <span class="badge rounded-pill placeholder fs-6" id="lbl_cx">Status Caixa</span>
                </div>
                <div class="modal-body">
                    <div class="d-flex flex-column p-2 gap-2 w-100 h-100 align-items-center">
                        <div class="d-flex flex-wrap w-100 gap-2">
                            <!-- Lista de Produtos -->
                            <div class="card flex-grow-1" style="flex-basis: 300px;">
                                <div class="card-header">
                                    <i class="bi bi-box-seam"></i> Produtos
                                </div>
                                <div class="card-body d-flex flex-column gap-2" style="max-height: 300px; overflow-y: auto;">
                                    <div class="form-floating">
                                        <input class="form-control" type="text" id="busca_nova_venda" placeholder="Busque um item">
                                        <label for="busca_nova_venda">Busque um item</label>
                                    </div>
                                    <table class="table">
                                        <thead>
                                            <td>Produto</td>
                                            <td>Ação</td>
                                        </thead>
                                        <tbody id="prods_nova_venda">

                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <!-- Carrinho -->
                            <div class="card flex-grow-1" style="flex-basis: 300px;">
                                <div class="card-header">
                                    <i class="bi bi-basket2-fill"></i> Carrinho
                                </div>
                                <div class="card-body d-flex flex-column gap-2" style="max-height: 300px; overflow-y: auto;">
                                    <ul class="list-group" id="carrinho">
                                        <span class="fs-6 text-center">Adicione um item ao carrinho!</span>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- <div class="alert alert-info" role="alert">
                            O valor de Venda é calculado de forma automática!
                        </div> -->
                        <div class="card flex-grow-1 w-100" style="flex-basis: 200px;">
                            <div class="card-header">
                                <i class="bi bi-info-lg"></i> Informações
                            </div>
                            <div class="card-body d-flex flex-column gap-2">
                                <span id="vl_pg">Valor a Pagar: </span>
                                <div class="d-flex flex-wrap gap-2">
                                    <div class="form-floating flex-grow-1" style="flex-basis: 300px;">
                                        <input class="form-control money-mask" type="text" name="busca" id="valor" placeholder="Busque um item" readonly>
                                        <label for="valor">Valor R$</label>
                                    </div>
                                    <div class="form-floating flex-grow-1" style="flex-basis: 300px;">
                                        <input class="form-control money-mask" type="text" name="busca" id="desconto" oninput="atualizar_desconto(this)" placeholder="Desconto">
                                        <label for="desconto">Desconto</label>
                                    </div>
                                </div>
                                <div class="form-floating">
                                    <select class="form-select" aria-placeholder="Método de Pagamento" id="mt_pg">
                                        <option value="debito">Débito</option>
                                        <option value="credito">Crédito</option>
                                        <option value="pix">PIX</option>
                                        <option value="dinheiro">Dinheiro</option>
                                    </select>
                                    <label for="mt_pg">Método de Pagamento</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary btn-lg" data-bs-dismiss="modal">Fechar</button>
                    <button class="btn btn-success btn-lg align-self-end" onclick="vender(this)">Vender</button>
                </div>
            </div>
        </div>
    </div>

    <div class="d-flex w-100 mb-4 justify-content-between">
        <span class="fs-4 fw-bold">Vendas.</span>
        <button class="btn btn-success" onclick="create_modal_vendas()"><i class="bi bi-plus-circle-fill"></i> Nova Venda</button>
    </div>

    <div class="d-flex border rounded p-2 gap-2 flex-column overflow-auto">
        <div id="tb_vendas"></div>
    </div>
    
    <!-- Scripts -->
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@6.3.1/dist/js/tabulator.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/inputmask@5.0.9/dist/jquery.inputmask.min.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="/js/gourmet.js"></script>
    <script>
        get_vendas(); cx();
        $(document).ready(function(){
            $("#busca_nova_venda").on("keyup", function() {
                var value = $(this).val().toLowerCase();
                $("#prods_nova_venda tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                });
            });
        });

    </script>
</body>
</html>